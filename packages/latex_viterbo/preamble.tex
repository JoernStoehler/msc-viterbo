% Centralized macros and theorem setup (arXiv-friendly, widely expected commands).

% Math helpers
\numberwithin{equation}{chapter}

\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\T}{\mathbb{T}}

\newcommand{\inner}[2]{\langle #1, #2 \rangle}
\newcommand{\abs}[1]{\lvert #1\rvert}
\newcommand{\norm}[1]{\lVert #1\rVert}
\newcommand{\vol}{\operatorname{vol}}
\newcommand{\diag}{\operatorname{diag}}
\newcommand{\Id}{\mathrm{Id}}
\newcommand{\op}[1]{\operatorname{#1}}

% Symplectic shorthand
\newcommand{\cEHZ}{c_{\mathrm{EHZ}}}
\newcommand{\sys}{\mathrm{sys}}
\newcommand{\gauge}{g}
\newcommand{\support}{h}
\newcommand{\polar}{\circ}

% Theorem styles
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{fact}[theorem]{Fact}
\newtheorem{conjecture}[theorem]{Conjecture}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}

% Cleveref names
\crefname{theorem}{Theorem}{Theorems}
\crefname{lemma}{Lemma}{Lemmas}
\crefname{proposition}{Proposition}{Propositions}
\crefname{corollary}{Corollary}{Corollaries}
\crefname{fact}{Fact}{Facts}
\crefname{conjecture}{Conjecture}{Conjectures}
\crefname{definition}{Definition}{Definitions}
\crefname{example}{Example}{Examples}
\crefname{remark}{Remark}{Remarks}
\crefname{equation}{Equation}{Equations}

% WIP references: \todoref{label} and \todocref{label} show visible TODOs
% while the label does not exist yet; once the label exists (i.e. on a later
% run where \r@<label> is defined), these raise a LaTeX error to force cleanup.
\makeatletter
\newcommand{\todoref}[1]{%
  \ifcsname r@#1\endcsname
    \PackageError{todoref}%
      {Label `#1' exists; replace \string\todoref\space with \string\ref\space or \string\cref}%
      {You are using \string\todoref\space with a label that already has a real reference.\MessageBreak
       Replace \string\todoref\space by \string\ref, \string\cref, or a related command.\MessageBreak
       This macro is only intended for temporary, forward references.}%
  \else
    \textbf{[TODO ref: #1]}%
  \fi}
\newcommand{\todocref}[1]{%
  \ifcsname r@#1\endcsname
    \PackageError{todocref}%
      {Label `#1' exists; replace \string\todocref\space with \string\cref}%
      {You are using \string\todocref\space with a label that already has a real reference.\MessageBreak
       Replace \string\todocref\space by \string\cref\space (or a related cleveref command).\MessageBreak
       This macro is only intended for temporary, forward references.}%
  \else
    \textbf{[TODO cref: #1]}%
  \fi}
\makeatother
