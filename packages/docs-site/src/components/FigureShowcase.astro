---
import PlotIsland from './PlotIsland';
import type { FigureMeta } from '../lib/thesis';
import { getFigureSpec, getStaticFigureUrl } from '../lib/figures';

interface Props {
  figure: FigureMeta;
}

const { figure } = Astro.props as Props;
const spec = getFigureSpec(figure.assets.interactive);
const staticUrl = getStaticFigureUrl(figure);
const staticSrc = staticUrl.pathname ?? staticUrl.href;
---
<section class=figure-showcase>
  <img src={staticSrc} alt={figure.caption ?? figure.title ?? figure.id} loading=lazy decoding=async />
  {spec && (
    <div class=figure-showcase__interactive>
      <PlotIsland spec={spec} title={figure.title ?? figure.caption} client:visible />
    </div>
  )}
  <figcaption>
    <strong>{figure.title ?? figure.id}</strong>
    {figure.caption && <span> â€” {figure.caption}</span>}
  </figcaption>
</section>
