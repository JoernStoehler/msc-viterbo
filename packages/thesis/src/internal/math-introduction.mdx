---
title: Symplectic Geometry on Polytopes (Introduction Draft)
slug: math-introduction
internal: true
summary: Working draft of the symplectic geometry introduction tailored to 4D convex polytopes.
---

# Symplectic Geometry on Polytopes: An Introduction

{/* writing style: book / reference; quickly get a MSc student up to speed for the rest of the thesis; literal, correct, explicit, fast to read top to bottom, skimmable via sections and paragraphs and bullet lists, focus on definitions and theorems, some focus on motivation mostly wrt why we care about describing some facts more than others, cite where we take notations from */}

This document serves as an introduction to symplectic geometry on polytopes. We assume the reader is familiar with symplectic geometry and contact topology in the smooth setting, with functional analysis and partial differential equations, with the basics of polytope geometry, with the basics of combinatorics, and with the basics of optimization theory, roughly on the level of a master student in mathematics who heard master's lectures on these topics.

The document focuses on theorems, definitions, notation, and aims that way to establish a productively useful framework to do symplectic geometry in the limiting case of polytopes. We only sketch a general motivation for why we picked definitions as we did, and why they are useful, but don't concretely argue for each definition on its own merits.

## Motivation

Given some smooth Hamiltonian $H \in C^\infty(\mathbb{R}^{2n}, \mathbb{R})$ with convex compact sublevel set $K = \{H \leq 1\}$, and assuming that $1$ is a regular value of $H$, we get that $\partial K$ is an immersed smooth hypersurface in $\mathbb{R}^{2n}$. Also assume that $0 \in \mathrm{int} K$. From the standard symplectic form $\omega_0$ and standard Liouville form $\lambda_0$ on $\mathbb{R}^{2n}$, we get that the restriction $\lambda_0|_{\partial K}$ is a contact form on $\partial K$.

In this smooth setting we can study the Reeb dynamics of the contact manifold $(\partial K, \lambda_0|_{\partial K})$, and the symplectic 
capacities of $K$. In particular, we can state the Viterbo conjecture, which turned out to be false, but is still of interest to us:

**Viterbo Conjecture (false).** Define the action, and minimum action of closed Reeb orbits on $\partial K$ as
$$A(\gamma) = \int_\gamma \lambda_0$$
$$A_{\min}(K) = \min \{A(\gamma): \gamma \text{ is a closed characteristic on } \partial K\}.$$
Then the conjecture states that
$$\frac{A_{\min}(K)^n}{n! \mathrm{vol}(K)} \leq 1.$$

Note that the Hamiltonian $H$ isn't relevant here, only the convex body $K$.
We are interested in algorithmically computing $A_{\min}(K)$. The simplest scenario, from a computational perspective, are piecewise linear closed characteristics. They occur on flat parts of $\partial K$. Thus, it is natural to consider how to define and study the Reeb dynamics on convex polytopes $K \subset \mathbb{R}^{2n}$, instead of on smooth convex bodies.

The general motivation that we use here is to consider polytopes as limits of smooth convex bodies, and ask what the smooth data converges to in the limit, and when the limit exists and if it is unique. 
In this document here we skip the exact arguments for why the definitions we pick are the right ones, i.e. why they describe relevant/interesting/unique limits of smooth data. Instead we simply state them, and refer to a later to-be-written appendix. We did not write down the arguments from practical experience, i.e. that some definitions work better than others to formalize interesting results.

None of the definitions are per-se novel, there's existing literature on polytopes in symplectic geometry, and we borrow notation mainly from \cite{Chaidez-Hutchings 2021}, \cite{Haim-Kislev 2017}, \cite{Haim-Kislev 2024}.

We only consider the case $2n=4$, which is the lowest non-trivial dimension. Lower dimensions lend themselves in our experience better to computations. There may be additional phenomena in higher dimensions, but they are out of scope for the whole thesis.

## Standard Symplectic Setting

We use the standard coordinates, symplectic form, Liouville form, complex structure on $\mathbb{R}^4$:
$$z = (q, p) = (q_1, q_2, p_1, p_2) \in \mathbb{R}^4$$
$$\omega_0 = dq_1 \wedge dp_1 + dq_2 \wedge dp_2$$
$$\lambda_0 = \frac{1}{2} \sum_{i=1}^2 (q_i dp_i - p_i dq_i)$$
$$J = \begin{pmatrix} 0 & -I \\ I & 0 \end{pmatrix}$$

We consider compact, convex polytopes $K \subset \mathbb{R}^4$ with $0 \in \mathrm{int} K$. We denote the boundary by $\partial K$.

We will later need the gauge function $g_K$ and the support function $h_K$ of $K$:
$$g_K(z) = \inf \{r > 0: z \in r K\}$$
$$h_K(z) = \sup_{w \in K} \langle z, w \rangle$$

We can use the gauge function to define a Hamiltonian whose $1$-sublevel set is $K$:
$$H(z) = g_K(z)^2.$$
Note that $H$ is convex, quadratic homogeneous, continuous, but not smooth in general.
We will denote the subdifferential of $H$, i.e. the set of subgradients at a point $z$, by
$$\partial H(z) = \{v \in \mathbb{R}^4: H(\cdot) \geq H(z) + \langle v, \cdot - z \rangle\}.$$

We will study loops with period $T$, i.e. maps $\mathbb{T} \to \partial K$, where $\mathbb{T} = \mathbb{R}/T\mathbb{Z}$ is the circle of length $T$.
In the smooth setting, we would study smooth loops in $C^\infty(\mathbb{T}, \partial K)$, but to work with polytopes we relax to the Sobolov space $W^{1,2}(\mathbb{T}, \partial K)$.

## Facets, Ridges, Edges, Vertices

The polytope $K$ can be described as the intersection of finitely many half-spaces:
$$K = \bigcap_{i=1}^m \{z \in \mathbb{R}^4: \langle z, n_i \rangle \leq h_i\}$$
for some count $m \in \mathbb{N}$, with $n_i \in \mathbb{R}^4$ the outward-pointing normal vector of the $i$-th facet, and $h_i = h_K(n_i) \in \mathbb{R}_{>0}$ the height of the $i$-th facet.
Without loss of generality we assume that the representation is irredundant, i.e. removing any of the half-spaces would strictly enlarge $K$ or make it unbounded.

We name the closed intersection of $\partial K$ with any bounding hyperplane a $3$-face, also called a facet:
$$F_i = \partial K \cap \{z \in \mathbb{R}^4: \langle z, n_i \rangle = h_i\}.$$
A facet is a compact, convex, non-degenerate and thus non-empty, $3$-dimensional polytope in its hyperplane.

We say two facets are neighbors if their closed intersection is a non-degenerate $2$-dimensional polytope, called a ridge or $2$-face:
$$F_{ij} = F_i \cap F_j.$$

**Lemma:** Three or more facets cannot share a common ridge. Thus, each ridge has a unique pair of neighboring facets.
**Proof:** Follows from irredundancy and convexity. $\square$

Similarly we name $1$-faces edges, and $0$-faces (which have themselves as interior) vertices. Unlike with ridges, we can have extra facets that share an edge or vertex, so there's no uniqueness statement here.

## Combinatorical Hamiltonian and Reeb Dynamics

On the interior of each facet $F_i$, we get the usual smooth Reeb dynamics and Hamiltonian dynamics.
The Reeb vector field is constant on $F_i$:
$$\lambda_0(R_i) = 1, \quad \iota_{R_i} d\lambda_0 = 0 \implies R_i = TODO.$$
The Hamiltonian vector field is also constant on $F_i$:
$$\iota_{X_H} \omega_0 = dH \implies X_H = J \nabla H = \frac{2}{h_i} J n_i =: p_i.$$
For Hamiltonian dynamics, we get linear flow lines with velocity $p_i$ on the interior of $F_i$.

We want to define dynamics now on the whole $\partial K$. Skipping the motivation, we arrive at the following definition:

**Definition:** A combinatorical Hamiltonian orbit on $\partial K$ with period $T$ is a loop $\gamma \in W^{1,2}(\mathbb{T}, \partial K)$ with dynamics defined almost everywhere by
$$\dot\gamma(t) \in J \partial H(\gamma(t)) = \mathrm{conv} \{p_i: \gamma(t) \in F_i\},$$
where $\mathrm{conv}$ are the convex combinations of the given vectors.

**Definition:** A closed characteristic of $K$ is a loop $\gamma \in W^{1,2}(S^1, \partial K)$ that almost everywhere satisfies
$$\dot\gamma(t) \in \mathrm{cone} \{R_i: \gamma(t) \in F_i\} \setminus \{0\},$$
where $\mathrm{cone}$ is the non-negative cone, i.e. any non-negative linear combination of the given vectors.
Note that any positively oriented reparametrization is again a closed characteristic.

**Lemma:** The combinatorical Hamiltonian orbits on $\partial K$ correspond, via positively oriented reparametrization and time-rescaling, to the combinatorical Reeb trajectories on $\partial K$.
**Proof:** Follows from the fact that $R_i, p_i$ differ by a positive scalar.

**Lemma:** For a ridge $F_{ij}$, the local Hamiltonian dynamics, and equivalently the Reeb dynamics, of a loop $\gamma$ fall into the following cases:
- doesn't touch the interior of $F_{ij}$
- if non-lagrangian: instantaneous crossing through an interior point of $F_{ij}$, with predetermined direction $F_i \to F_j$ or $F_j \to F_i$
- if lagrangian: enters $F_{ij}$ on its boundary, continues on $F_{ij}$, and leaves $F_{ij}$ on its boundary. The velocity of the Hamiltonian orbit is almost everywhere a convex combination of $p_i$ and $p_j$, which are both tangent to $F_{ij}$.
**Proof:** Convexity and irredundancy of $K$ gives us that either the ridge is lagrangian with tangent and distinct $p_i, p_j$, or there's a predetermined direction of crossing that both $p_i$, $p_j$ obey. $\square$

## Minimal Action

We define the action of trajectories similarly to the smooth case:

**Definition:** For any closed loop $\gamma \in W^{1,2}(\mathbb{T}, \partial K)$, we define its action as
$${A}(\gamma) = \int_\gamma \lambda_0 = \int_0^T \lambda_0(\dot\gamma(t)) dt = \frac{1}{2} \int_0^T \langle -J \dot\gamma(t), \gamma(t) \rangle dt.$$
The action is invariant under orientation-preserving reparametrizations and rescalings of $\gamma$.

**Definition:** The minimal action of $K$ is defined as
$${A}_{\min}(K) = \min \{{A}(\gamma): \gamma \text{ is a closed characteristic on } \partial K\}.$$

**Lemma:** The critical points of the action functional $A$ on the space of arbitrary closed loops $W^{1,2}(\mathbb{T}, \partial K)$ are the closed characteristics, and their reversed counterparts. Note that constant loops are not critical points.
**Proof:** Follows from variational calculus. $\square$

**Lemma:** The action of a Hamiltonian orbit $\gamma$ with period $T$ is
$${A}(\gamma) = T.$$
**Proof:** We can simply calculate.
For a velocity $p_i$ at point $z$ on facet $F_i$, we have
$$\langle -J p_i, z \rangle = \langle -J \frac{2}{h_i} J n_i, z \rangle = \frac{2}{h_i} \langle n_i, z \rangle = 2,$$
since $z \in F_i$.
Thus, for almost every $t$ we have $\langle -J \dot\gamma(t), \gamma(t) \rangle = 2$, and integrating over $[0,T]$ gives the result. $\square$

## Clarke's Dual Action Principle

We can apply the Clarke's dual action principle and find an equivalent optimization problem.
See \cite{Haim-Kislev 2017} for this approach.

**Problem (Action minimization):** Find the minimum of the action functional
$$A(\gamma) := \int_0^T \langle -J \dot\gamma(t), \gamma(t) \rangle dt,$$
$$\gamma \in W^{1,2}(\mathbb{T}, \partial K).$$

**Problem (Dual):** Find the minimum of the dual action functional
$$I_K(z) = \frac{1}{4} \int_0^1 h_K^2(-J \dot z(t)) dt,$$
$$z \in \mathcal E := W^{1,2}(S^1, \mathbb{R}^4), \quad \int_0^1 \langle -J \dot z(t), z(t) \rangle dt = 1.$$

**Fact**: The tangent space $T_z \mathcal E$ is given by for $\xi \in W^{1,2}(S^1, \mathbb{R}^4)$:
$$\xi \in T_z \mathcal E \iff \int_0^1 \langle -J \dot \xi(t), z(t) \rangle = 0 \iff \int_0^1 \langle -J \dot z(t), \xi(t) \rangle = 0.$$
**Proof:** Variation of the constraint of $E$, and partial integration.

To get from the action problem to the dual problem, we need the Fenchel dual of $H(z) = g_K(z)^2$, which is
$$H^*(w) = \max_{z \in \mathbb{R}^4} \{\langle w, z \rangle - H(z)\} = \max_{r > 0} \max_{z \in r K} \{\langle w, z \rangle - r^2\} = \max_{r > 0} \{r h_K(w) - r^2\}.$$
The maximum is taken at $h_H(w) = 2 r$, giving $H^*(w) = h_K(w)^2/4$.
The argmax $z$ in the first equation is taken at $z$ with $w \in \partial H(z)$, which is the case for whole faces of some scaled body $h_K(w)/2 \cdot K$, i.e. $0$-faces if a single vertex is the argmax, $1$-faces if an edge is the argmax, etc.
We have $H^*(w) + H(z) \geq \langle w, z \rangle$ for all $w, z$, with equality iff $w \in \partial H(z)$ iff $z \in \partial H^*(w)$.

We now want to show that the critical points of $I_K$ and $A$ correspond to each other.

**Theorem:** For any critical point of $A$ there is a corresponding loop 
$$z \in \mathcal E^\dagger = \{z \in \mathcal E: \exists a \in \mathbb{R}^4, \quad 8 I_K(z) z + a \in \partial h_K^2(-J \dot z) \text{ a.e.}\}.$$
**Proof:**
First we note that any critical point $\gamma$ of $A$ can be reparameterized and time-scaled to become a Hamiltonian orbit with period $T$. We then have
$$-J \dot\gamma(t) \in \partial g_K^2(\gamma(t))$$
Per Fenchel duality we have
$$\gamma(t) \in \partial \frac{1}{4} h_K^2(-J \dot\gamma(t))$$
We will define $z$ via $\gamma(t) = a z(t/T) + b$ for some $a \in \mathbb{R}_{>0}$, $b \in \mathbb{R}^4$ to be determined later.
This gets us $\dot\gamma (t) = a / T \dot z(t/T)$.
We then have
$$a z(t/T) + b \in \partial \frac{1}{4} h_K^2(-J a/T \dot z (t/T))$$
$$4 a^2 / T^2 (a z + b) \in \partial h_K^2(-J \dot z).$$
We need to pick $a,b$ such that
$$z \in \mathcal E, \quad \iff 2 A(z) = \int_0^1 \langle -J \dot z(t), z(t) \rangle dt = 1,$$
and
$$8 I_K(z) z + c = 4 a^2 / T^2 (a z + b)$$
for some $c \in \mathbb{R}^4$.
First we note that $A(\gamma)=a^2 A(z)$ due to time-scaling and translation invariance and $2$-homogenity of spatial scaling.
Thus, we want $a = \sqrt{A(\gamma)/2} = \sqrt{T/2}$.
Next, we calculate $I_K(z)$:
From the Fenchel duality we have
$$T + I_K(\gamma) = \int_0^T g_K^2(\gamma(t)) + \frac{1}{4} h_K^2(-J \dot\gamma(t)) dt \geq \int_0^T \langle -J \dot\gamma(t), \gamma(t) \rangle dt = 2 A(\gamma) = 2 T.$$
We satisfy equality, since $\gamma$ and $- J \dot\gamma$ correspond to each other.
We use the scaling of $I_K$ to get
$$I_K(\gamma) = \int_0^T \frac{1}{4} h_K^2(-J \dot\gamma(t)) dt = T \int_0^1 \frac{1}{4} h_K^2(-J a / T \dot z(t)) dt = a^2 / T I_K(z).$$
Thus, we have
$$T + a^2 / T I_K(z) = 2 T \implies I_K(z) = T^2 / a^2 = 2 T.$$
Finally, we need to pick $b$ such that
$$8 I_K(z) z + c = 4 a^2 / T^2 (a z + b)$$
for some $c \in \mathbb{R}^4$.
Plugging in $I_K(z) = 2 T$, $a = \sqrt{T/2}$ gives
$$16 T z + c = \frac{4 T}{2 T^2}(\sqrt{T/2} z + b) = \frac{2}{T} (\sqrt{T/2} z + b).$$


if we take
$$z = \frac{1}{T} \gamma + b$$
for some $b \in \mathbb{R}^4$ to be determined later, we have
$$- J \dot z(t) \in \partial g_K^2(\gamma(t))$$
$$ \gamma(t) \in \partial \frac{1}{4} h_K^2(-J \dot z(t))$$
Or, plugging in $\gamma$:
$$ 4 T (z - b) \in \partial h_K^2(-J \dot z(t))$$
almost everywhere.
We also have that the action of $\gamma$ is $A(\gamma) = T$.


almost everywhere. And per an earlier lemma, we have
$$A(\gamma) = T.$$
For
$$z = \frac{1}{T} \gamma + b$$
we have
$$\dot z(t) \in J \partial g_K^2(\gamma(t))$$
and by Fenchel duality
$$\gamma(t) \in \partial \frac{1}{4} h_K^2(-J \dot z(t))$$
almost everywhere.
Again by Fenchel duality we have
$$1 + I_K(z) = \int_0^1 g_K^2(\gamma(t)) + \frac{1}{4} h_K^2(-J \dot z(t)) dt = \int_0^1 \langle -J \dot z(t), \gamma(t) \rangle dt.$$
Substituting $\gamma$ gives
$$1 + I_K(z) = \int_0^1 \langle -J \dot z(t), T z(t) - T b \rangle dt = T \int_0^1 \langle -J \dot z(t), z(t) \rangle dt = 2 T A(z) = 2 T A(\gamma)/T^2 = 2.$$
Thus $I_K(z) = 1$.

We define $z = \frac{1}{T} \gamma + b$ for some $b \in \mathbb{R}^4$ to be determined later.
Equivalently, $\gamma = T (z - b)$.
By $2$-homogenity and translation invariance of $A$ we get $A(z) = 1/T$.
We then have $- J \dot z(t) \in \partial g_K^2(\gamma(t))$ almost everywhere.
By the Fenchel duality we have
$$\gamma(t) \in \partial h_K^2(-J \dot z(t))$$
almost everywhere.
We also have that
$$1 + I_K(z) = \int_0^1 g_K^2(\gamma(t)) + \frac{1}{4} h_K^2(-J \dot z(t)) dt = \int_0^1 \langle -J \dot z(t), \gamma(t) \rangle dt.$$
Substituting $\gamma$ gives
$$1 + I_K(z) = \int_0^1 \langle -J \dot z(t), T z(t) - T b \rangle dt = T \int_0^1 \langle -J \dot z(t), z(t) \rangle dt = T A(z).$$


**Theorem:** The set of (weak) critical points of $I_K$ is
$$\mathcal E^\dagger = \{z \in \mathcal E: \exists a \in \mathbb{R}^4, \quad 8 I_K(z) z + a \in \partial h_K^2(-J \dot z) \text{ a.e.}\}.$$
They also correspond to the set of (weak) critical points of $A$ via the mapping $T=A()
$$
**Proof:** 

First an observation about $T_z \mathcal E$:
The change of the constraint $1 = \int_0^1 \langle -J \dot z(t), z(t) \rangle dt$ at $z$ in direction $\xi$ is
$$0 = \int_0^1 \langle -J \dot \xi(t), z(t) \rangle + \langle -J \dot z(t), \xi(t) \rangle dt + o(\|\xi\|).$$
Partial integration however gives us
$$\int_0^1 \langle -J \dot \xi(t), z(t) \rangle dt = - \int_0^1 \langle -J \xi(t), \dot z(t) \rangle dt = \int_0^1 \langle -J \dot z(t), \xi(t) \rangle dt,$$
which shows that the two terms are equal to zero.

(1) We show that $z \in \mathcal E^\dagger$ implies that $z$ is a critical point of $I_K$.
There exists $a \in \mathbb{R}^4$ such that $8 I_K(z) z + a \in \partial h_K^2(-J \dot z)$ a.e. 
Fix a variation $\xi \in T_z \mathcal E$.
Per definition of the subdifferential we have
$$h_K^2(-J (\dot z + \dot \xi)) \geq h_K^2(-J \dot z) + \langle 8 I_K(z) z + a, -J \dot \xi \rangle.$$
When integrating over $[0,1]$ we can use 
$$\int_0^1 \dot\xi(t) dt = 0$$
$$\int_0^1 \langle -J \dot \xi(t), z(t) \rangle dt = o(\|\xi\|)$$
to get
$$I_K(z + \xi) \geq I_K(z) + o(\|\xi\|).$$
This shows that $z$ is a critical point of $I_K$.

(2) Next we show that for a critical point $\gamma$ of $A$ we get a critical point $z$ of $I_K$.
We already know that critical points of $A$ are closed characteristics, and thus are up to reparametrization and time scaling a Hamiltonian orbit.
We thus can pick a reparametrization and period $T>0$ such that almost everywhere
$$\frac{1}{T} \dot\gamma(t) \in J \partial g_K^2(\gamma(t))$$
Define $z = \frac{1}{T} \gamma + b for some $b \in \mathbb{R}^4$ to be determined later.
We then have $- J \dot z(t) \in \partial g_K^2(\gamma(t))$ a.e.

By the Fenchel duality we have
$$g_K^2(\gamma(t)) + \frac{1}{4} h_K^2(-J \dot z(t)) \geq \langle \gamma(t), -J \dot z(t) \rangle,$$
with equality iff $-J \dot z(t) \in \partial g_K^2(\gamma(t))$ iff $\gamma(t) \in \partial h_K^2(-J \dot z(t))$.
Since the first condition holds a.e., we get the second condition a.e. as well.
Integrating over $[0,1]$ we get
$$1 + I_K(z) = \int_0^1 \langle \gamma(t), -J \dot z(t) \rangle dt = \frac{1}{T} \int_0^1 \langle \gamma(t), -J \dot\gamma(t) \rangle dt = \frac{1}{T} A(\gamma).$$



We want that $\gamma = 8 I_K(z) z + a$ for some $a \in \mathbb{R}^4$.


The Fenchel dual of $g_K^2$ is $h_K^2/4$. Proof:
$$H^*(w) = \max_{z \in \mathbb{R}^4} \{\langle w, z \rangle - g_K(z)^2\} = \max_{r > 0} \max_{z \in r K} \{\langle w, z \rangle - r^2\} = \max_{r > 0} \{r h_K(w) - r^2\}.$$
Latter maximum is taken at $h_K(w) = 2 r$, giving $H^*(w) = h_K(w)^2/4$.

For Fenchel duality we have
$$g_K^2(z) + \frac{1}{4} h_K^2(w) \geq \langle z, w \rangle,$$
with equality iff $w \in \partial g_K^2(z)$ iff $z \in \partial h_K^2(w)$.

Since $H(\gamma)=1$ for $\gamma \in W^{1,2}(S^1, \partial K)$, we have
$$1 = \int_0^1 H(\gamma(t)) dt$$
This gives us
$$1 + I_K(z) = \int_0^1 g_K^2(\gamma(t)) + \frac{1}{4} h_K^2(-J \dot z(t)) dt \geq \int_0^1 \langle -J \dot z(t), \gamma(t) \rangle dt.$$
Equality holds iff a.e. we have $-J \dot z(t) \in \partial g_K^2(\gamma(t))$ iff a.e. we have $\gamma(t) \in \partial h_K^2(-J \dot z(t))$.

If we pick a critical $\gamma$ of $A$, we know that after a reparametrization we have $\dot\gamma(t) \in J \partial g_K^2(\gamma(t))$
We define $z$ via 
$$
